window.Router={routes:[],init(t){this.routes=t,window.addEventListener("hashchange",()=>this.handleHashChange()),window.addEventListener("load",()=>this.handleHashChange()),this.handleHashChange()},async handleHashChange(){let t=window.location.hash.slice(1)||"/",e="/",o=null;if(t.startsWith("/")){const a=t.split("#");e=a[0],o=a[1]||null}else if(t)return o=t,this.scrollToAnchor(o),void this.updateActiveAnchors(o);const[a,i]=e.split("?");let n=this.routes.find(t=>t.path===a),s={};if(!n)for(const t of this.routes)if(t.path.includes(":")){const e="^"+t.path.replace(/:[a-zA-Z0-9_]+/g,"([^/]+)")+"$",o=new RegExp(e),i=a.match(o);if(i){n=t;const e=(t.path.match(/:[a-zA-Z0-9_]+/g)||[]).map(t=>t.slice(1));i.slice(1).forEach((t,o)=>{s[e[o]]=t});break}}if(this.params=s,this.currentPath=a,window.Store&&window.Store.set("params",s),n||(n=this.routes.find(t=>"/404"===t.path)||{component:"app/pages/404.html"}),n.beforeEnter){if(!await n.beforeEnter())return}window.Framework&&window.Framework.cache&&delete window.Framework.cache[n.component],n.title?document.title=n.title:document.title="Staco - Advanced Lightweight SPA",await Framework.render(n.component,"router-view"),this.updateActiveLinks(a),o&&setTimeout(()=>this.scrollToAnchor(o),100),window.dispatchEvent(new CustomEvent("route:changed",{detail:{path:a,params:s}})),window.dispatchEvent(new CustomEvent("route-changed",{detail:{path:a,params:s}}))},updateActiveLinks(t){document.querySelectorAll('[href^="#/"]').forEach(e=>{const o=e.getAttribute("href").slice(1).split("#")[0],a=t===o||"/"!==o&&t.startsWith(o+"/");e.classList.toggle("nav-link-active",a),e.classList.toggle("active-link",a)})},updateActiveAnchors(t){document.querySelectorAll('[href^="#"]:not([href^="#/"])').forEach(e=>{const o=e.getAttribute("href");if(!o||"#"===o)return;const a=o.slice(1)===t;e.classList.toggle("nav-anchor-active",a)})},scrollToAnchor(t){const e=document.getElementById(t);e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),this.updateActiveAnchors(t))},navigate(t){window.location.hash=t}};